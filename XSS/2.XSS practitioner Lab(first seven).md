**Step1**

First we open page view page


**Step2**

Now we view page source code

The script creates a dropdown menu with store names ("London", "Paris", "Milan"). If the URL contains a storeId parameter, that store name is pre-selected in the dropdown. The dropdown will include all stores, but the one matching the storeId parameter (if any) will be selected by default and not duplicated.

**Step3:**

Now we click on check stock and intercept the request


Here we can see clearly the storeId is set to london

**Step4:**

Now when we use this payload in url

`x"></select><img src=x onerror=\x10"javascript:alert(1)">`

It show image in


**Step5:**

Now we try

`&storeId="></select><img%20src=1%20onerror=alert(1)>`

Alternative payload

`&storeId="><script src=1 href=1 onerror="javascript:alert(1)"></script>`

URL encoded

`&storeId="><script+src%3d1+href%3d1+onerror%3d"javascript%3aalert(1)"></script>`


**Step1:**

First we search for any thing



**Step2:**

Now we view page source

Here it store search string in variable and then search the item

**Step3:**

Now try this payload to

`\';alert(document.domain)//`

So the searchTerms='\';alert(document.domain)//'


And the lab is solved


**Step1:**

First we search for any string



**Step2:**

Now we view page source



Here we have no such hint

Now I inspect the result



ng-pristine and ng-valid are AngularJS-specific classes used for managing the state and validation status of form controls.

**Step3:**

As we know the site contain ng-app attribute

After searching I found that it is used with {{}}

Like:
```
<body ng-app="">

<p>My first expression: {{ 5 + 5 }}</p>

</body>
```

  
**Step4:**

Now we search for {{alert(1)}} in search bar

So it show that it is not reading {{alert(1)}} as string

Now I found a payload to cause alert(1)

`{{constructor.constructor('alert(1)')()}}`

Alernative payload

`{{$on.constructor('alert(1)')()}}`

Or

`{{''.constructor.constructor('alert(1)')()}}`



**Step1:**

First we write any string

In proxy tab->http history  we can see

**Step2:**

If we view page source code of search functionality it look like

It is clear that the search value is used in

 eval('var searchResultsObj = ' + this.responseText);

**Step3**  
based on json responce we try `\"` and see result

Json response

**Step4**  
to exploit this we use

`\"-alert(1)}//`


**Step1:**

First we write a simple comment and see response. Go to view post and write a comment

The comment is save in normal behavior

**Step2:**

Now we view page source.

Opening

`/resources/js/loadCommentsWithVulnerableEscapeHtml.js file`


After analyzing this JavaScript code I can clearly see "< " is replace with &lt; and ">" with &gt;

So I use this payload

`<><img src=x onerroralert('xss')>`

So it only encode the first opning and closing bracket

Now click on back button and lab will solve by showing alert message

Alternative payload
`<><video src="x" onerror=alert(1)></video>`

`<><audio src="x" onerror=alert(1)></audio>`

**Step1:**

First we try with common tags like img and video and see result

From the result its very clear that the tag is not allowed

**Step2**

Now we use intruder to solve this lab by testing all tags and find the allowed tag

So first I search for normal value and send the search reuqest to intruder

Now change the search to

For payload we copy all tag element from XSS cheat sheet

Paste them in payload

From the result it is clear that these two tags are allowed

**Step3**

Try payload with body tag

After trying this payload we see attribute not allowed

So we find the allowed attribute.All step are same as in step2  but this time we use payload events


Here is the allowed tag

**Step4**

So know we use html tag like

Now we use this payload to solve

`<iframe src="https://0afc00bf03f7a66a84a37da600300093.web-security-academy.net/?search="><body onresize=print()>" onload=this.style.width='100px'>`

Url encoded

`<iframe src="https://0afc00bf03f7a66a84a37da600300093.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>`


Store it and deliver it to victim


**Step1**

In this we try custom tags because all tags are blocked


And this is working

**Step2**

Now we try a simple payload

`<xss onfocus=alert(1) autofocus tabindex=1>`

And the alert message is triggring

**Step3**

So we use this script to solve the lab
```
<script>

location = '[https://0a3500e6039d93388058582900fe0002.web-security-academy.net/?search=<xss](https://0a3500e6039d93388058582900fe0002.web-security-academy.net/?search=%3cxss) id=x onfocus=alert(document.cookie) tabindex=1>#x';

</script>
```

URL Encoded
```
<script>

location = '[https://0a3500e6039d93388058582900fe0002.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x](https://0a3500e6039d93388058582900fe0002.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x)';

</script>
```

**Step4**

Store exploit in exploit server and deliver it to victim



**Step1:**

Trying SVG tag and normal html

It says that tag not allowed

But for <svg> tag it says

**Step2**

Now when I am trying `<svg onafterscriptexecute=alert(1)>` it says event not allowed

**Step3**

So first we find all allowed svg tags

Using all tags from xss cheat sheet

Copying tags

From the result it is clear that following svg tags are allowed



**Step4:**

Now we use svg tag like image

And the result is very clear.

**Step5:**

Now we try event



And it gives error that event not allowed

So we find event. Same as we found tag.but thus time we use payload list of events



In Intruder we select


And in payload we paste the result



From result it is clear onbegin event is allowed


**Step6:**

We try this payload now

`<svg><animatetransform onbegin=alert(1)></svg>`

And lab is solved
